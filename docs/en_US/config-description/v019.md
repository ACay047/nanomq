# Configuration Parameters
This document introduces the HOCON configuration for NanoMQ 0.19 or higher versions. 

**ðŸ“¢Attention:** The configuration method of the conf file no longer includes the "enable" option. Any configuration that appears in the configuration file is enabled by default.



## Log

Log in NanoMQ allows you to customize how the broker generates and manages log files. This configuration includes settings for the destination of the logs, the log levels, and the handling of log file rotation.

**Example Configuration**

```hcl
log = {
  to = [file, console]                  # Destination of the logs
  level = "warn"                        # Log level
  dir = "/tmp"                          # Directory for log files
  file = "nanomq.log"                   # Filename for the log file
  rotation = {
    size = "10MB"                       # Maximum size of each log file
    count = 5                           # Maximum rotation count of log files
  }
}
```

**Configuration Items**

- `to`: Specifies the destination(s) where the logs will be emitted. Optional values:
  - `file`: Write logs to a file.
  - `console`: Write logs to standard I/O
  - `syslog`: Wwrite logs to syslog
- `level`: Specifies the log level. Only messages with a severity level equal to or higher than this level will be logged. Optional values:
  - `trace`
  - `debug`
  - `info`
  - `warn`
  - `error`
  - `fatal`
- `dir`: Specifies the directory where log files will be stored.
- `file`: Specifies the filename for the log file.
- `rotation`: Specifies the settings for log file rotation.
  - `size`: Specifies the maximum size of each log file. Once a log file reaches this size, it will be rotated. The value can be specified in KB, MB, or GB.
  - `count`: Specifies the maximum rotation count of log files. When the count limit is reached, the oldest log file will be deleted upon the next rotation.



## Gateway

### ZMQ Gateway

**Example Configuration**

**Configuration Items**





### SOME/IP Gateway

**Example Configuration**

**Configuration Items**







### DDS Gateway

**Example Configuration**

**Configuration Items

## HTTP Authorization Configuration

HTTP authentication plugin only works for CONNECT, PUBLISH & SUBSCRIBE are not implemented yet.
HTTP authentication does not support HTTPS for now.

| Name                              | Type | Description                                                     | default                                                         |
| ----------------------------------- | -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| auth.http_auth.auth_req.url              | String   | Specify the target URL of the authentication request. | `http://127.0.0.1:80/mqtt/auth`                              |
| auth.http_auth.auth_req.method           | String     | Specify the request method of the authentication request.<br>(`POST`  , `GET`) | `POST`                                                       |
| auth.http_auth.auth_req.headers.\<Any\>  | String   | Specify the data in the HTTP request header. `<Key>` Specify the field name in the HTTP request header, and the value of this configuration item is the corresponding field value. `<Key>` can be the standard HTTP request header field. User can also customize the field to configure multiple different request header fields. | `auth.http_auth.auth_req.headers.content-type = application/x-www-form-urlencoded` <br/>`auth.http_auth.auth_req.headers.accept = */*` |
| auth.http_auth.auth_req.params           | Array[Object]    | Specify the data carried in the authentication request. <br>When using the **GET** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent as query string parameters. <br>When using the **POST** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent in the form of Request Body. All placeholders will be replaced by run-time data , and the available placeholders are as follows:<br>`%u: Username`<br>`%c: MQTT Client ID`<br>`%a: Client's network IP address`<br>`%r: The protocol used by the client can be:mqtt, mqtt-sn, coap, lwm2m and stomp`<br>`%P: Password`<br>`%p: Server port for client connection`<br>`%C: Common Name in client certificate`<br>`%d: Subject in client certificate` | `auth.http_auth.auth_req.params = {clientid= "%c", username= "%u", password= "%P"}`                        |
| auth.http_auth.super_req.url             | String   | Specify the target URL for the superuser authentication request. | `http://127.0.0.1:80/mqtt/superuser`                         |
| auth.http_auth.super_req.method          | String   | Specifies the request method of the super user authentication request.<br>(`POST`  , `GET`) | `POST`                                                       |
| auth.http_auth.super_req.headers.\<Any\> | String   | Specify the data in the HTTP request header. `<Key>` Specify the field name in the HTTP request header, and the value of this configuration item is the corresponding field value. `<Key>` can be the standard HTTP request header field. User can also customize the field to configure multiple different request header fields. | `auth.http_auth.super_req.headers.content-type = application/x-www-form-urlencoded`<br/>`auth.http_auth.super_req.headers.accept = */*` |
| auth.http_auth.super_req.params          | Array[Object]    | Specify the data carried in the authentication request. <br>When using the **GET** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent as query string parameters. <br>When using the **POST** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent in the form of Request Body. All placeholders will be replaced by run-time data , and the available placeholders are the same as those of `auth.http_auth.auth_req.params`. | `auth.http_auth.super_req.params = {clientid= "%c", username= "%u", password= "%P"}`                                    |
| auth.http_auth.acl_req.url               | String   | Specify the target URL for ACL verification requests. | `http://127.0.0.1:8991/mqtt/acl`                             |
| auth.http_auth.acl_req.method            | String   | Specifies the request method for ACL verification requests.<br>(`POST`  , `GET`) | `POST`                                                       |
| auth.http_auth.acl_req.headers.\<Any\>   | String   | Specify the data in the HTTP request header. `<Key>` Specify the field name in the HTTP request header, and the value of this configuration item is the corresponding field value. `<Key>` can be the standard HTTP request header field. User can also customize the field to configure multiple different request header fields. | `auth.http_auth.super_req.headers.content-type = application/x-www-form-urlencoded`<br/>`auth.http_auth.super_req.headers.accept = */*` |
| auth.http_auth.acl_req.params            | Array[Object]    | Specify the data carried in the authentication request. <br>When using the **GET** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent as query string parameters. <br>When using the **POST** method, the value of `auth.http_auth.auth_req.params` will be converted into `k=v` key-value pairs separated by `&` and sent in the form of Request Body. All placeholders will be replaced by run-time data , and the available placeholders are as follows:<br/>`%A: Permission to be verified, 1 means subscription, 2 means publish`<br>`%u: UserName`<br/>`%c: MQTT Client ID`<br/>`%a: Client network IP address`<br/>`%r: The protocol used by the client can be: mqtt, mqtt-sn, coap, lwm2m and stomp`<br/>`%m: Mount point`<br>`%t: Topic` | `auth.http_auth.acl_req.params = {clientid = "%c", username = "%u", access = "%A", ipaddr = "%a", topic = "%t", mountpoint = "%m"}` |
| auth.http_auth.timeout                   | Integer  | HTTP request timeout. Any setting equivalent to `0s` means never timeout. | `5s`                                                         |
| auth.http_auth.connect_timeout           | Integer  | Connection timeout for HTTP requests. Any setting value equivalent to `0s` means never time out. | `5s`                                                         |

Example :

```bash
http_auth = {
  auth_req {
    url = "http://127.0.0.1:80/mqtt/auth"
    method = post
    headers.content-type = "application/x-www-form-urlencoded"
    params = {clientid = "%c", username = "%u", password = "%p"}
  }

  super_req {
    url = "http://127.0.0.1:80/mqtt/superuser"
    method = "post"
    headers.content-type = "application/x-www-form-urlencoded"
    params = {clientid = "%c", username = "%u", password = "%p"}
  }

  acl_req {
    url = "http://127.0.0.1:8991/mqtt/acl"
    method = "post"
    headers.content-type = "application/x-www-form-urlencoded"
    params = {clientid = "%c", username = "%u", access = "%A", ipaddr = "%a", topic = "%t", mountpoint = "%m"}
  }

  timeout = 5s
  connect_timeout = 5s
  pool_size = 32
}
```

### Rule configuration for SQLite

Name                         | Type   | Description
---------------------------- | ------ | ------------------------------------------------------------------------
rules.sqlite.path             | String | Rule engine option SQLite3 database path, default is /tmp/rule_engine.db
rules.sqlite.rules[0].table   | String | Rule engine option SQLite3 database table name
rules.sqlite.rules[0].sql     | String | Rule engine sql clause

### Rule configuration for MySQL

Name                                | Type   | Description
----------------------------------  | ------ | ----------------------------------------------------------------
rules.mysql.name.conn.database      | String | Rule engine option mysql database name, default is mysql_rule_db
rules.mysql.name.conn.host          | String | Rule engine option mysql database host
rules.mysql.name.conn.username      | String | Rule engine option mysql database username
rules.mysql.name.conn.password      | String | Rule engine option mysql database password
rules.mysql.name.rules[0].table     | String | Rule engine option mysql database table name
rules.mysql.name.rules[0].sql       | String | Rule engine sql clause

### Rule configuration for repub

Name                            | Type    | Description
------------------------------- | ------- | ----------------------------------------------------------
rules.repub.rules[0].server      | String  | Rule engine option repub address (mqtt-tcp://host:port)
rules.repub.rules[0].topic       | String  | Rule engine option repub topic
rules.repub.rules[0].username    | String  | Rule engine option repub username
rules.repub.rules[0].password    | String  | Rule engine option repub password
rules.repub.rules[0].proto_ver   | Integer | Rule engine option repub protocol version, default is 4
rules.repub.rules[0].clientid    | String  | Rule engine option repub clientid
rules.repub.rules[0].keepalive   | Duration| Rule engine option repub keepalive
rules.repub.rules[0].clean_start | Boolean | Rule engine option repub clean_start flag, default is true
rules.repub.rules[0].sql         | String  | Rule engine sql clause

